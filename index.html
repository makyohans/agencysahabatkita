<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Daftar - Agency Sahabat Kita</title>
    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet"/>
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.3/dist/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <style>
      .form-container{
        max-width:640px;
        margin:40px auto;
        padding:20px;
        background:#fff;
        box-shadow:0 0 10px rgba(0,0,0,0.06);
      }
      .payment-toggle .btn{ min-width:150px; }
      /* Warna khusus untuk membedakan */
      .btn-bank{ background:#007bff; color:#fff; border-color:#007bff; }
      .btn-ewallet{ background:#28a745; color:#fff; border-color:#28a745; }
      .btn-bank.active, .btn-ewallet.active{ opacity:0.95; }
      .hidden{ display:none; }
      .small-note{ font-size:0.85rem; color:#666; }
    </style>
  </head>
  <body class="bg-light">
    <div class="container">
      <div class="form-container">
        <h4 class="text-center mb-3">Form Pendaftaran Pembayaran</h4>

        <form id="submit-to-google-sheet">
          <div class="form-group">
            <label for="nama_faya">NAMA FAYA</label>
            <input class="form-control" type="text" id="nama_faya" name="nama_faya" placeholder="NAMA FAYA" required />
          </div>

          <div class="form-group">
            <label for="id_faya">ID FAYA</label>
            <input class="form-control" type="text" id="id_faya" name="id_faya" placeholder="ID FAYA" required />
          </div>

          <div class="form-group">
            <label for="nomor_hp_wa">NOMOR HP/WA</label>
            <input class="form-control" type="tel" id="nomor_hp_wa" name="nomor_hp_wa" placeholder="08xxxxxxxxxx" required />
          </div>

          <div class="form-group">
            <label>PILIH METODE (BANK atau E-WALLET)</label>
            <div class="btn-group d-flex payment-toggle" role="group" aria-label="payment type">
              <button id="btn-bank" class="btn btn-bank active" type="button" data-type="bank">BANK</button>
              <button id="btn-ewallet" class="btn btn-ewallet ml-2" type="button" data-type="ewallet">E-WALLET</button>
            </div>
            <div class="small-note mt-1">Klik tombol untuk memilih jenis; lalu pilih provider dan masukkan nomor/ID.</div>
          </div>

          <!-- Bank inputs -->
          <div id="bank-section">
            <div class="form-group">
              <label for="id_bank_ewallet_bank">ID BANK (pilih)</label>
              <select class="form-control" id="id_bank_ewallet_bank" >
                <option value="" disabled selected hidden>Pilih bank...</option>
                <!-- Daftar bank umum di Indonesia (lengkap) -->
                <option value="Bank Central Asia (BCA)">Bank Central Asia (BCA)</option>
                <option value="Bank Rakyat Indonesia (BRI)">Bank Rakyat Indonesia (BRI)</option>
                <option value="Bank Negara Indonesia (BNI)">Bank Negara Indonesia (BNI)</option>
                <option value="Bank Mandiri">Bank Mandiri</option>
                <option value="CIMB Niaga">CIMB Niaga</option>
                <option value="Permata Bank">Permata Bank</option>
                <option value="Bank Danamon">Bank Danamon</option>
                <option value="Bank Bukopin">Bank Bukopin</option>
                <option value="Bank Panin">Bank Panin</option>
                <option value="Bank OCBC NISP">Bank OCBC NISP</option>
                <option value="Bank Maybank Indonesia">Bank Maybank Indonesia</option>
                <option value="Bank BTN">Bank BTN</option>
                <option value="Bank Mega">Bank Mega</option>
                <option value="Bank BTPN">Bank BTPN</option>
                <option value="Bank Bukalapak (Bank KB Bukopin)">Bank Bukalapak</option>
                <option value="Bank BSI (Bank Syariah Indonesia)">Bank BSI</option>
                <option value="Bank Syariah Mandiri">Bank Syariah Mandiri</option>
                <option value="Bank Muamalat">Bank Muamalat</option>
                <option value="Bank Jabar Banten (BJB)">Bank Jabar Banten (BJB)</option>
                <option value="Bank BPD">Bank BPD</option>
                <option value="HSBC Indonesia">HSBC Indonesia</option>
                <option value="Standard Chartered">Standard Chartered</option>
                <option value="Citibank">Citibank</option>
                <option value="Bank Central Asia Syariah">BCA Syariah</option>
                <option value="Lainnya">Lainnya</option>
              </select>
            </div>
            <div class="form-group">
              <label for="nomor_bank_ewallet_bank">NOMOR REKENING (Bank)</label>
              <input class="form-control" type="text" id="nomor_bank_ewallet_bank" placeholder="Nomor rekening" />
            </div>
          </div>

          <!-- Ewallet inputs -->
          <div id="ewallet-section" class="hidden">
            <div class="form-group">
              <label for="id_bank_ewallet_ewallet">ID E-WALLET (pilih)</label>
              <select class="form-control" id="id_bank_ewallet_ewallet" >
                <option value="" disabled selected hidden>Pilih e-wallet...</option>
                <!-- Daftar e-wallet populer di Indonesia -->
                <option value="GoPay">GoPay</option>
                <option value="OVO">OVO</option>
                <option value="DANA">DANA</option>
                <option value="ShopeePay">ShopeePay</option>
                <option value="LinkAja">LinkAja</option>
                <option value="BCA Mobile (Dompet) - jika menggunakan">BCA Mobile</option>
                <option value="Jenius Pay">Jenius Pay</option>
                <option value="Shopeepay Later">ShopeePay Later</option>
                <option value="Bank-specific e-wallet (contoh) ">Bank-specific e-wallet</option>
                <option value="Lainnya">Lainnya</option>
              </select>
            </div>
            <div class="form-group">
              <label for="nomor_bank_ewallet_ewallet">NOMOR / ID E-WALLET</label>
              <input class="form-control" type="text" id="nomor_bank_ewallet_ewallet" placeholder="Nomor atau ID e-wallet" />
            </div>
          </div>

          <div class="form-group">
            <label for="nama_pemilik">NAMA PEMILIK</label>
            <input class="form-control" type="text" id="nama_pemilik" name="nama_pemilik" placeholder="Nama pemilik rekening/akun" required />
          </div>

          <!-- Hidden consolidated fields to sendâ€”these are the exact column names you requested -->
          <input type="hidden" name="id_bank_ewallet" id="id_bank_ewallet" value="" />
          <input type="hidden" name="nomor_bank_ewallet" id="nomor_bank_ewallet" value="" />
          <input type="hidden" name="payment_type" id="payment_type" value="bank" />

          <div class="form-group mt-3">
            <button type="submit" class="btn btn-primary btn-block">Kirim</button>
          </div>
        </form>
      </div>
    </div>

    <script>
      // Ganti dengan URL Web App Apps Script Anda setelah deploy
      const scriptURL = "https://script.google.com/macros/s/AKfycbzxwvYgO9a3bpKjz8bNdIhno-gpp_sC5gqtmjJtQlecI8TEbo7LddQj-84xyuCHnZjyeg/exec";

      const btnBank = document.getElementById('btn-bank');
      const btnEwallet = document.getElementById('btn-ewallet');
      const bankSection = document.getElementById('bank-section');
      const ewalletSection = document.getElementById('ewallet-section');

      // bank inputs
      const idBankBank = document.getElementById('id_bank_ewallet_bank');
      const nomorBankBank = document.getElementById('nomor_bank_ewallet_bank');
      // ewallet inputs
      const idEwallet = document.getElementById('id_bank_ewallet_ewallet');
      const nomorEwallet = document.getElementById('nomor_bank_ewallet_ewallet');

      // hidden consolidated fields to send
      const hiddenId = document.getElementById('id_bank_ewallet');
      const hiddenNomor = document.getElementById('nomor_bank_ewallet');
      const hiddenType = document.getElementById('payment_type');

      // default = bank
      function showBank(){
        btnBank.classList.add('active');
        btnEwallet.classList.remove('active');
        bankSection.classList.remove('hidden');
        ewalletSection.classList.add('hidden');
        hiddenType.value = 'bank';
        // set required attributes for UX (final check done before submit)
        idBankBank.required = true;
        nomorBankBank.required = true;
        idEwallet.required = false;
        nomorEwallet.required = false;
      }
      function showEwallet(){
        btnEwallet.classList.add('active');
        btnBank.classList.remove('active');
        ewalletSection.classList.remove('hidden');
        bankSection.classList.add('hidden');
        hiddenType.value = 'ewallet';
        idEwallet.required = true;
        nomorEwallet.required = true;
        idBankBank.required = false;
        nomorBankBank.required = false;
      }

      btnBank.addEventListener('click', function(){ showBank(); });
      btnEwallet.addEventListener('click', function(){ showEwallet(); });

      showBank(); // inisialisasi

      const form = document.getElementById('submit-to-google-sheet');
      form.addEventListener('submit', function(e){
        e.preventDefault();

        // Isi hidden fields sesuai pilihan
        if (!bankSection.classList.contains('hidden')) {
          hiddenId.value = idBankBank.value || "";
          hiddenNomor.value = nomorBankBank.value || "";
        } else {
          hiddenId.value = idEwallet.value || "";
          hiddenNomor.value = nomorEwallet.value || "";
        }

        // Ambil hanya field yang Anda minta
        const payload = new FormData();
        payload.append('nama_faya', document.getElementById('nama_faya').value || "");
        payload.append('id_faya', document.getElementById('id_faya').value || "");
        payload.append('nomor_hp_wa', document.getElementById('nomor_hp_wa').value || "");
        payload.append('id_bank_ewallet', hiddenId.value || "");
        payload.append('nama_pemilik', document.getElementById('nama_pemilik').value || "");
        payload.append('nomor_bank_ewallet', hiddenNomor.value || "");
        payload.append('payment_type', hiddenType.value || "");

        fetch(scriptURL, { method: 'POST', body: payload })
          .then(response => response.json ? response.json() : response.text())
          .then(result => {
            alert('Data berhasil dikirim.');
            form.reset();
            showBank();
          })
          .catch(err => {
            alert('Terjadi kesalahan saat mengirim. Cek Web App URL dan izin.');
            console.error(err);
          });
      });
    </script>
  </body>
</html>
